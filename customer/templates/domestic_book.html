{% extends 'base.html' %}
{% load static %}
{% block head %}
  <link rel="stylesheet" type="text/css" href="{% static 'css/category.css' %}">
{% endblock head %}

{% block title %}
서점 검색 페이지 | alleybookstore
{% endblock title %}

{% block _nav %}
  {% include '_nav.html' %}
{% endblock _nav %}

{% block body %}

<div class="container">
  <div class="flex">
    <div class="aside">
      <li>
        <a href="">
            <div class="topnav">연습</div>
          </a>
        <ul class="subnav">
          <li>1</li>
          <li>2</li>
        </ul>
      </li>
      <form class="mt-3" method="post" enctype="multipart/form-data" action=''>{% csrf_token %}
    <select name="province" id="province">
        <option>---------- 도 ----------</option>
        {% for main in mains %}
            <option>{{ main.name }}</option>
        {% endfor %}
    </select>

    <select name="city" id="city">
        <option>---------- 시 ----------</option>
    </select>
    <br>
    <button type="submit" class="btn btn-primary">검색</button>
</form>
    </div>

    <div class="content">
      <p>책을 넣을 자리</p>
    </div>
  </div>
</div>


<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script type="text/javascript">
    $(function(){
        $('#province').change(function() {
            var main_name = this.value

            $.ajax({
                type: "POST",
                url: "{% url 'customer:ajax_get_subcategory' %}",
                data: {'main_name': main_name, 'csrfmiddlewaretoken': '{{ csrf_token }}'},
                dataType: "json",
                success: function(response){
                    var items = "<option>---------- 시 ----------</option>";
                    for(var i=0; i<response.subs.length; i++){
                        items += ("<option>" + response.subs[i].name  + "</option>")
                    }

                    $("#city").html(items);
                },
                error: function(request, status, error){
                    alert(error);
                },
            });
        });
    });


</script>
{% block footer %}
{% include 'footer.html' %}
{% endblock footer  %}

{% endblock body %}